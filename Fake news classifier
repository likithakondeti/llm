import huggingface_hub
from huggingface_hub import hf_hub_download
from transformers import AutoTokenizer, AutoModel
import torch
from sklearn.metrics.pairwise import cosine_similarity

tokenizer = AutoTokenizer.from_pretrained("bert-base-uncased")
model = AutoModel.from_pretrained("bert-base-uncased")

text1 = "Machine learning is useful"
text2 = "AI is very helpful"


t1 = tokenizer(text1, return_tensors="pt")
t2 = tokenizer(text2, return_tensors="pt")


with torch.no_grad():
    e1 = model(**t1).last_hidden_state.mean(dim=1)
    e2 = model(**t2).last_hidden_state.mean(dim=1)


score = cosine_similarity(e1, e2)
print("Similarity:", score[0][0])
